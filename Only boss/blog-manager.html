<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Blog Manager - Md Akhinoor Islam's Portfolio | Presented by A3KM Studio" />
  <title>Blog Manager - Md Akhinoor Islam | A3KM Studio</title>
  <link rel="icon" href="../images/favicon.svg" type="image/svg+xml" />
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #1a1a1a 0%, #2d0a0a 50%, #1a0000 100%);
      min-height: 100vh;
      padding: 20px;
      color: #333;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      border-radius: 16px;
      padding: 32px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.15);
    }
    h1 {
      color: #CC0000;
      margin-bottom: 24px;
      font-size: 28px;
    }
    h2 {
      color: #CC0000;
      margin: 24px 0 16px;
      font-size: 20px;
    }
    .auth-section {
      background: #f9f9f9;
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 24px;
      border: 2px solid #e0e0e0;
    }
    .auth-section.verified {
      border-color: #4caf50;
      background: #e8f5e9;
    }
    input, textarea, select {
      width: 100%;
      padding: 12px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 14px;
      margin-bottom: 12px;
      font-family: inherit;
    }
    input:focus, textarea:focus, select:focus {
      outline: none;
      border-color: #CC0000;
    }
    textarea {
      min-height: 200px;
      font-family: 'Courier New', monospace;
      resize: vertical;
    }
    button {
      padding: 12px 24px;
      border: none;
      border-radius: 8px;
      background: #CC0000;
      color: white;
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-right: 8px;
      margin-bottom: 8px;
    }
    button:hover {
      background: #990000;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(204, 0, 0, 0.4);
    }
    button.secondary {
      background: #888;
    }
    button.secondary:hover {
      background: #666;
    }
    button.danger {
      background: #e74c3c;
    }
    button.danger:hover {
      background: #c0392b;
    }
    .post-list {
      margin-top: 16px;
    }
    .post-item {
      background: #f9f9f9;
      padding: 16px;
      border-radius: 8px;
      margin-bottom: 12px;
      border: 2px solid #e0e0e0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .post-item h3 {
      margin: 0 0 4px 0;
      font-size: 16px;
      color: #333;
    }
    .post-item .meta {
      font-size: 12px;
      color: #888;
    }
    .post-item .actions {
      display: flex;
      gap: 8px;
    }
    .post-item button {
      padding: 6px 12px;
      font-size: 12px;
      margin: 0;
    }
    .output {
      background: #f5f5f5;
      padding: 16px;
      border-radius: 8px;
      margin-top: 16px;
      border: 2px solid #e0e0e0;
      font-family: 'Courier New', monospace;
      font-size: 12px;
      max-height: 300px;
      overflow-y: auto;
      white-space: pre-wrap;
      word-break: break-word;
    }
    .success {
      background: #e8f5e9;
      border-color: #4caf50;
      color: #2e7d32;
    }
    .error {
      background: #ffebee;
      border-color: #f44336;
      color: #c62828;
    }
    .hidden {
      display: none;
    }
    label {
      display: block;
      font-weight: 600;
      margin-bottom: 6px;
      color: #555;
      font-size: 13px;
    }
    .form-group {
      margin-bottom: 16px;
    }
    .tag-input {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      align-items: center;
    }
    .tag-badge {
      background: #CC0000;
      color: white;
      padding: 4px 10px;
      border-radius: 12px;
      font-size: 12px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    .tag-badge span {
      cursor: pointer;
      font-weight: bold;
    }
  </style>
  <link rel="stylesheet" href="../Optimization/navbar-autohide.css">
</head>
<body>
  <div class="container">
    <h1>üìù Blog Manager - Md Akhinoor Islam</h1>
    <p style="color: #CC0000; font-size: 14px; margin-bottom: 20px;">Portfolio by A3KM Studio | Only Boss Access</p>
    
    <!-- Authentication -->
    <div id="auth-section" class="auth-section">
      <label>Enter Access Token:</label>
      <input type="password" id="token-input" placeholder="Your secret token..." />
      <button onclick="authenticate()">Unlock Manager</button>
      <div id="auth-message" class="output hidden"></div>
    </div>
    
    <!-- Manager Content (hidden until authenticated) -->
    <div id="manager-content" class="hidden">
      
      <h2>üìù Create New Post</h2>
      <div class="form-group">
        <label>Post Title:</label>
        <input type="text" id="post-title" placeholder="Welcome to My Blog" />
      </div>
      
      <div class="form-group">
        <label>Slug (URL-friendly):</label>
        <input type="text" id="post-slug" placeholder="welcome-to-my-blog" />
      </div>
      
      <div class="form-group">
        <label>Summary:</label>
        <input type="text" id="post-summary" placeholder="Short description of the post..." />
      </div>
      
      <div class="form-group">
        <label>Date (YYYY-MM-DD):</label>
        <input type="date" id="post-date" />
      </div>
      
      <div class="form-group">
        <label>Tags (comma-separated):</label>
        <input type="text" id="post-tags" placeholder="electronics, arduino, tutorial" />
        <div id="tag-preview" class="tag-input"></div>
      </div>
      
      <div class="form-group">
        <label>Cover Image (path):</label>
        <input type="text" id="post-cover" placeholder="images/blog/my-post.jpg" />
      </div>
      
      <div class="form-group">
        <label>Status:</label>
        <select id="post-status">
          <option value="draft">Draft (Hidden)</option>
          <option value="published">Published (Visible)</option>
        </select>
      </div>
      
      <div class="form-group">
        <label>Post Content (Markdown):</label>
        <textarea id="post-content" placeholder="# Heading

Your markdown content here...

- List item 1
- List item 2

**Bold text** and *italic text*."></textarea>
      </div>
      
      <button onclick="generatePost()">üìÑ Generate Post Files</button>
      <button class="secondary" onclick="clearForm()">üóëÔ∏è Clear Form</button>
      <button class="secondary" onclick="loadExistingPosts()">üîÑ Refresh Posts</button>
      
      <div id="output" class="output hidden"></div>
      
      <h2>üìã Existing Posts</h2>
      <div id="post-list" class="post-list">
        <p style="color:#888;">Loading...</p>
      </div>
      
      <h2>üìñ Instructions</h2>
      <div class="output" style="background:#fff3cd; border-color:#ffc107; color:#856404;">
        <strong>How to use:</strong><br>
        1. Fill out the form above to create a new post.<br>
        2. Click "Generate Post Files" to get the Markdown file and updated posts.json.<br>
        3. Copy the generated content and manually create/update the files in your repo:<br>
           - Save the Markdown to <code>content/blog/posts/&lt;slug&gt;.md</code><br>
           - Replace <code>content/blog/posts.json</code> with the updated JSON<br>
           - Upload cover image to <code>images/blog/</code><br>
        4. Commit and push to GitHub.<br>
        5. Update RSS manually if needed (or use the RSS generator below).<br><br>
        <strong>Note:</strong> This is a client-side tool. No files are automatically saved to your repo. You must manually copy/paste the generated content.
      </div>
      
    </div>
  </div>
  
  <script>
    // SECURE TOKEN - Updated by Boss
    // Generated from: generate-password-hash.html
    const TOKEN_HASH = 'd7a5f8187ceede6c093445dad128e1b4ea2a21d91348a219b947ce2b70416212'; // Custom password
    let authenticated = false;
    let postsData = [];
    
    // Simple SHA-256 hash function
    async function sha256(message) {
      const msgBuffer = new TextEncoder().encode(message);
      const hashBuffer = await crypto.subtle.digest('SHA-256', msgBuffer);
      const hashArray = Array.from(new Uint8Array(hashBuffer));
      return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
    }
    
    async function authenticate() {
      const token = document.getElementById('token-input').value.trim();
      const hash = await sha256(token);
      const authMsg = document.getElementById('auth-message');
      
      if (hash === TOKEN_HASH) {
        authenticated = true;
        document.getElementById('auth-section').classList.add('verified');
        document.getElementById('manager-content').classList.remove('hidden');
        authMsg.textContent = '‚úÖ Authentication successful!';
        authMsg.classList.remove('hidden', 'error');
        authMsg.classList.add('success');
        loadExistingPosts();
        setDefaultDate();
      } else {
        authMsg.textContent = '‚ùå Invalid token. Access denied.';
        authMsg.classList.remove('hidden', 'success');
        authMsg.classList.add('error');
      }
    }
    
    function setDefaultDate() {
      const today = new Date().toISOString().split('T')[0];
      document.getElementById('post-date').value = today;
    }
    
    async function loadExistingPosts() {
      if (!authenticated) return;
      
      try {
        const response = await fetch('content/blog/posts.json');
        postsData = await response.json();
        renderPostList();
      } catch (err) {
        document.getElementById('post-list').innerHTML = '<p style="color:#e74c3c;">Failed to load posts.</p>';
      }
    }
    
    function renderPostList() {
      const container = document.getElementById('post-list');
      if (postsData.length === 0) {
        container.innerHTML = '<p style="color:#888;">No posts yet.</p>';
        return;
      }
      
      const sorted = [...postsData].sort((a, b) => new Date(b.date) - new Date(a.date));
      
      container.innerHTML = sorted.map(post => `
        <div class="post-item">
          <div>
            <h3>${escapeHtml(post.title)}</h3>
            <div class="meta">
              ${post.date} ‚Ä¢ ${post.tags ? post.tags.join(', ') : ''} ‚Ä¢ ${post.status}
            </div>
          </div>
          <div class="actions">
            <button class="secondary" onclick="editPost(${post.id})">‚úèÔ∏è Edit</button>
            <button class="danger" onclick="deletePost(${post.id})">üóëÔ∏è Delete</button>
          </div>
        </div>
      `).join('');
    }
    
    function escapeHtml(text) {
      const div = document.createElement('div');
      div.innerText = text;
      return div.innerHTML;
    }
    
    function generatePost() {
      if (!authenticated) {
        alert('Please authenticate first.');
        return;
      }
      
      const title = document.getElementById('post-title').value.trim();
      const slug = document.getElementById('post-slug').value.trim();
      const summary = document.getElementById('post-summary').value.trim();
      const date = document.getElementById('post-date').value.trim();
      const tagsStr = document.getElementById('post-tags').value.trim();
      const tags = tagsStr ? tagsStr.split(',').map(t => t.trim()) : [];
      const coverImage = document.getElementById('post-cover').value.trim();
      const status = document.getElementById('post-status').value;
      const content = document.getElementById('post-content').value.trim();
      
      if (!title || !slug || !date || !content) {
        alert('Please fill in required fields: Title, Slug, Date, and Content.');
        return;
      }
      
      // Generate Markdown file
      const frontMatter = `---
title: ${title}
date: ${date}
tags: [${tags.join(', ')}]
summary: ${summary}
coverImage: ${coverImage}
status: ${status}
---

`;
      const markdown = frontMatter + content;
      
      // Update posts.json
      const newId = postsData.length > 0 ? Math.max(...postsData.map(p => p.id)) + 1 : 1;
      const newPost = {
        id: newId,
        slug,
        title,
        summary,
        date,
        tags,
        coverImage,
        status
      };
      
      const updatedPosts = [...postsData, newPost];
      const postsJson = JSON.stringify(updatedPosts, null, 2);
      
      // Display output
      const output = document.getElementById('output');
      output.classList.remove('hidden', 'error');
      output.classList.add('success');
      output.textContent = `‚úÖ Post generated successfully!

üìÑ Markdown File: content/blog/posts/${slug}.md
---
${markdown}
---

üìã Updated posts.json:
---
${postsJson}
---

üìå Next Steps:
1. Copy the Markdown content above and save it as: content/blog/posts/${slug}.md
2. Copy the posts.json content and replace: content/blog/posts.json
3. Upload cover image to: ${coverImage}
4. Commit and push to GitHub
5. Your blog will automatically update!
`;
      
      // Update local cache
      postsData = updatedPosts;
      renderPostList();
    }
    
    function clearForm() {
      document.getElementById('post-title').value = '';
      document.getElementById('post-slug').value = '';
      document.getElementById('post-summary').value = '';
      document.getElementById('post-tags').value = '';
      document.getElementById('post-cover').value = '';
      document.getElementById('post-content').value = '';
      document.getElementById('post-status').value = 'draft';
      setDefaultDate();
      document.getElementById('output').classList.add('hidden');
    }
    
    function editPost(id) {
      const post = postsData.find(p => p.id === id);
      if (!post) return;
      
      document.getElementById('post-title').value = post.title;
      document.getElementById('post-slug').value = post.slug;
      document.getElementById('post-summary').value = post.summary || '';
      document.getElementById('post-date').value = post.date;
      document.getElementById('post-tags').value = (post.tags || []).join(', ');
      document.getElementById('post-cover').value = post.coverImage || '';
      document.getElementById('post-status').value = post.status;
      
      // Load markdown content
      fetch(`content/blog/posts/${post.slug}.md`)
        .then(r => r.text())
        .then(text => {
          // Remove front matter
          const contentOnly = text.replace(/^---[\s\S]*?---\n\n/, '');
          document.getElementById('post-content').value = contentOnly;
        })
        .catch(() => {
          document.getElementById('post-content').value = '# Content not found\n\nPlease add your content here.';
        });
      
      window.scrollTo(0, 0);
      alert(`Editing post: ${post.title}\n\nMake your changes and click "Generate Post Files" to update.`);
    }
    
    function deletePost(id) {
      const post = postsData.find(p => p.id === id);
      if (!post) return;
      
      if (!confirm(`Are you sure you want to delete "${post.title}"?\n\nNote: You will need to manually delete the markdown file and update posts.json in your repo.`)) {
        return;
      }
      
      const updatedPosts = postsData.filter(p => p.id !== id);
      const postsJson = JSON.stringify(updatedPosts, null, 2);
      
      const output = document.getElementById('output');
      output.classList.remove('hidden', 'success');
      output.classList.add('error');
      output.textContent = `üóëÔ∏è Post marked for deletion: ${post.title}

üìã Updated posts.json (without this post):
---
${postsJson}
---

‚ö†Ô∏è Manual Steps Required:
1. Delete the file: content/blog/posts/${post.slug}.md
2. Replace content/blog/posts.json with the content above
3. Commit and push to GitHub
`;
      
      postsData = updatedPosts;
      renderPostList();
    }
    
    // Auto-generate slug from title
    document.getElementById('post-title').addEventListener('input', (e) => {
      const title = e.target.value;
      const slug = title.toLowerCase()
        .replace(/[^a-z0-9\s-]/g, '')
        .replace(/\s+/g, '-')
        .replace(/-+/g, '-')
        .trim();
      document.getElementById('post-slug').value = slug;
    });
    
    // Preview tags
    document.getElementById('post-tags').addEventListener('input', (e) => {
      const tagsStr = e.target.value.trim();
      const tags = tagsStr ? tagsStr.split(',').map(t => t.trim()).filter(Boolean) : [];
      const preview = document.getElementById('tag-preview');
      preview.innerHTML = tags.map(tag => `<span class="tag-badge">${escapeHtml(tag)}</span>`).join('');
    });
  </script>
  <script src="../Optimization/navbar-autohide.js"></script>
</body>
</html>
