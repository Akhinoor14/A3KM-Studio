<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Book Reader - Md Akhinoor Islam</title>
  <link rel="icon" href="../../images/favicon.svg" type="image/svg+xml" />
  <link rel="stylesheet" href="../../Optimization/styles.css" />
  <link rel="stylesheet" href="../../Optimization/navbar/desktop-navbar.css" />
  <link rel="stylesheet" href="../written-posts/post-viewer.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <meta name="theme-color" content="#CC0000" />
  <style>
    .book-container { max-width: 1200px; margin: 95px auto 60px; padding: 0 40px; }
    .pdf-viewer-wrapper { background: rgba(10,10,10,0.95); border: 3px solid rgba(204,0,0,0.3); border-radius: 20px; padding: 20px; margin: 30px 0; box-shadow: 0 15px 60px rgba(0,0,0,0.8); }
    .pdf-controls { display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; background: rgba(0,0,0,0.7); border-radius: 12px; margin-bottom: 20px; flex-wrap: wrap; gap: 15px; }
    .pdf-nav { display: flex; align-items: center; gap: 15px; }
    .pdf-btn { padding: 10px 18px; background: rgba(204,0,0,0.2); border: 2px solid rgba(204,0,0,0.3); border-radius: 10px; color: #fff; font-weight: 600; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; gap: 8px; }
    .pdf-btn:hover { background: rgba(204,0,0,0.4); border-color: #CC0000; }
    .pdf-btn:disabled { opacity: 0.4; cursor: not-allowed; }
    .page-info { color: rgba(255,255,255,0.8); font-weight: 600; font-size: 0.95rem; }
    .page-input { width: 60px; padding: 8px; background: rgba(0,0,0,0.5); border: 2px solid rgba(204,0,0,0.3); border-radius: 8px; color: #fff; text-align: center; font-weight: 600; }
    .zoom-controls { display: flex; gap: 10px; align-items: center; }
    .zoom-btn { width: 38px; height: 38px; padding: 0; display: flex; align-items: center; justify-content: center; }
    .zoom-value { min-width: 60px; text-align: center; color: rgba(255,255,255,0.8); font-weight: 600; }
    .download-btn { background: linear-gradient(135deg, #CC0000, #990000); border-color: transparent; }
    .download-btn:hover { background: linear-gradient(135deg, #FF0000, #CC0000); transform: translateY(-2px); }
    .pdf-canvas-container { text-align: center; background: #fff; border-radius: 12px; padding: 20px; min-height: 600px; display: flex; align-items: center; justify-content: center; }
    #pdfCanvas { max-width: 100%; height: auto; box-shadow: 0 10px 40px rgba(0,0,0,0.3); }
    .book-info-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin: 30px 0; }
    .info-card { background: rgba(10,10,10,0.9); border: 2px solid rgba(204,0,0,0.3); border-radius: 12px; padding: 20px; }
    .info-label { font-size: 0.85rem; color: rgba(255,255,255,0.6); margin-bottom: 8px; text-transform: uppercase; letter-spacing: 0.5px; }
    .info-value { font-size: 1.1rem; color: #fff; font-weight: 700; }
    .loading-pdf { text-align: center; padding: 100px 20px; }
    .loading-pdf i { font-size: 4rem; color: #CC0000; margin-bottom: 20px; animation: spin 2s linear infinite; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
  </style>
</head>
<body>
    <!-- CENTRALIZED BACKGROUND SYSTEM -->
    <div class="bg-system-container">
        <!-- Animated Background Elements -->
        <div class="bg-hero-bg-elements">
            <!-- Geometric Shapes -->
            <div class="bg-geometric-shapes">
                <div class="bg-shape bg-shape-1"></div>
                <div class="bg-shape bg-shape-2"></div>
                <div class="bg-shape bg-shape-3"></div>
                <div class="bg-shape bg-shape-4"></div>
                <div class="bg-shape bg-shape-5"></div>
            </div>
            
            <!-- Gradient Orbs -->
            <div class="bg-gradient-orbs">
                <div class="bg-orb bg-orb-1"></div>
                <div class="bg-orb bg-orb-2"></div>
                <div class="bg-orb bg-orb-3"></div>
            </div>
            
            <!-- Particle Canvas -->
            <canvas id="particles-canvas" class="bg-particles-canvas"></canvas>
        </div>
        
        <!-- Dark Overlay for Contrast -->
        <div class="bg-system-overlay"></div>
        
        <!-- PAGE CONTENT WRAPPER -->
        <div class="bg-system-content">
  <nav class="desktop-navbar" id="desktopNavbar">
    <div class="desktop-nav-container">
      <a href="../../Home/index.html" class="desktop-nav-logo" title="A3KM Studio - Home">
        <img src="../../images/logo.svg" alt="A3KM Studio Logo" class="desktop-nav-logo-img" width="55" height="55">
        <div class="desktop-nav-brand">
          <span class="desktop-nav-brand-name" data-text="A3KM Studio">A3KM Studio</span>
          <span class="desktop-nav-brand-tagline">Engineering Â· Innovation</span>
        </div>
      </a>
      <ul class="desktop-nav-menu">
        <li class="desktop-nav-item"><a href="../../About me/about.html" class="desktop-nav-link"><i class="fas fa-user-circle"></i><span>About</span></a></li>
        <li class="desktop-nav-item"><a href="../../Projects Code/projects.html" class="desktop-nav-link"><i class="fas fa-folder-open"></i><span>Projects</span></a></li>
        <li class="desktop-nav-item"><a href="../hub.html" class="desktop-nav-link active"><i class="fas fa-layer-group"></i><span>Content Studio</span></a></li>
        <li class="desktop-nav-item"><a href="../../Contact/contact.html" class="desktop-nav-link"><i class="fas fa-envelope"></i><span>Contact</span></a></li>
        <li class="desktop-nav-item"><a href="../../About%20me/CV/2313014%20CV.pdf" class="desktop-nav-link desktop-nav-cv-btn" download><i class="fas fa-download"></i><span>CV</span></a></li>
      </ul>
    </div>
  </nav>

  <div class="back-to-hub"><a href="../hub.html" class="back-btn"><i class="fas fa-arrow-left"></i><span>Back to Content Studio</span></a></div>

  <div class="post-loading" id="bookLoading"><i class="fas fa-spinner fa-spin"></i><span>Loading book...</span></div>

  <article class="book-container" id="bookContent" style="display: none;">
    <header class="post-header">
      <div class="post-badge"><i class="fas fa-book"></i><span>Book / PDF</span></div>
      <h1 class="post-title" id="bookTitle">Loading...</h1>
      <div class="post-meta">
        <div class="meta-item"><i class="fas fa-user"></i><span id="bookAuthor">-</span></div>
        <div class="meta-item"><i class="fas fa-file-pdf"></i><span id="bookPages">0 pages</span></div>
        <div class="meta-item"><i class="fas fa-calendar"></i><span id="bookYear">-</span></div>
      </div>
      <div class="post-tags" id="bookTags"></div>
      <div class="share-buttons">
        <span class="share-label">Share:</span>
        <button class="share-btn facebook" onclick="shareBook('facebook')"><i class="fab fa-facebook-f"></i></button>
        <button class="share-btn twitter" onclick="shareBook('twitter')"><i class="fab fa-twitter"></i></button>
        <button class="share-btn whatsapp" onclick="shareBook('whatsapp')"><i class="fab fa-whatsapp"></i></button>
        <button class="share-btn link" onclick="copyBookLink()"><i class="fas fa-link"></i></button>
      </div>
    </header>

    <div class="book-info-grid">
      <div class="info-card"><div class="info-label">Author</div><div class="info-value" id="authorInfo">-</div></div>
      <div class="info-card"><div class="info-label">Pages</div><div class="info-value" id="pagesInfo">-</div></div>
      <div class="info-card"><div class="info-label">Publisher</div><div class="info-value" id="publisherInfo">-</div></div>
      <div class="info-card"><div class="info-label">Language</div><div class="info-value" id="languageInfo">-</div></div>
    </div>

    <div class="post-content" id="bookDescription"></div>

    <div class="pdf-viewer-wrapper">
      <div class="pdf-controls">
        <div class="pdf-nav">
          <button class="pdf-btn" id="prevPage" onclick="changePage(-1)"><i class="fas fa-chevron-left"></i></button>
          <div class="page-info">
            <span>Page </span>
            <input type="number" id="pageInput" class="page-input" min="1" value="1" onchange="goToPage()">
            <span> of </span>
            <span id="totalPages">0</span>
          </div>
          <button class="pdf-btn" id="nextPage" onclick="changePage(1)"><i class="fas fa-chevron-right"></i></button>
        </div>
        
        <div class="zoom-controls">
          <button class="pdf-btn zoom-btn" onclick="zoomOut()"><i class="fas fa-search-minus"></i></button>
          <span class="zoom-value" id="zoomValue">100%</span>
          <button class="pdf-btn zoom-btn" onclick="zoomIn()"><i class="fas fa-search-plus"></i></button>
        </div>

        <button class="pdf-btn download-btn" id="downloadBtn" onclick="downloadPDF()">
          <i class="fas fa-download"></i><span>Download PDF</span>
        </button>
      </div>

      <div class="pdf-canvas-container">
        <div class="loading-pdf" id="pdfLoading">
          <i class="fas fa-file-pdf"></i>
          <p style="color: rgba(255,255,255,0.8); font-weight: 600;">Loading PDF viewer...</p>
          <p style="color: rgba(255,255,255,0.6); font-size: 0.9rem; margin-top: 10px;">PDF.js integration required. For now, use download button above.</p>
        </div>
        <canvas id="pdfCanvas" style="display: none;"></canvas>
      </div>
    </div>

    <footer class="post-footer">
      <div class="footer-actions">
        <button class="action-btn bookmark-btn" id="bookmarkBtn"><i class="far fa-bookmark"></i><span>Bookmark</span></button>
      </div>
    </footer>
  </article>

  <footer class="footer">
    <div class="container">
      <p>&copy; 2025 Md Akhinoor Islam. All rights reserved.</p>
      <p style="font-size: 0.9rem; color: rgba(255,255,255,0.6); margin-top: 8px;">Portfolio presented by <strong>A3KM Studio</strong></p>
    </div>
  </footer>

  <!-- PDF.js Library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
  
  <script src="../../About me/about-engineering-background.js"></script>
  <script>
    // Configure PDF.js worker
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';
    
    const urlParams = new URLSearchParams(window.location.search);
    const bookId = urlParams.get('id');
    let currentBook = null;
    let currentPage = 1;
    let totalPages = 0;
    let zoomLevel = 1.0;
    let pdfDoc = null;
    let pageRendering = false;
    let pageNumPending = null;

    async function loadBook() {
      if (!bookId) return;
      try {
        const response = await fetch('books.json');
        const data = await response.json();
        currentBook = data.books.find(b => b.id === bookId);
        if (currentBook) renderBook();
      } catch (error) { console.error('Error:', error); }
    }

    function renderBook() {
      document.getElementById('bookTitle').textContent = currentBook.title;
      document.getElementById('bookAuthor').textContent = currentBook.author;
      document.getElementById('bookPages').textContent = `${currentBook.pages} pages`;
      document.getElementById('bookYear').textContent = currentBook.year || new Date(currentBook.date).getFullYear();
      document.getElementById('authorInfo').textContent = currentBook.author;
      document.getElementById('pagesInfo').textContent = currentBook.pages;
      document.getElementById('publisherInfo').textContent = currentBook.publisher || 'Self-published';
      document.getElementById('languageInfo').textContent = currentBook.language || 'English';
      document.getElementById('bookDescription').innerHTML = `<p>${currentBook.description || currentBook.summary}</p>`;
      document.title = `${currentBook.title} - Md Akhinoor Islam`;

      if (currentBook.tags) {
        document.getElementById('bookTags').innerHTML = currentBook.tags.map(tag => `<span class="post-tag">${tag}</span>`).join('');
      }

      totalPages = currentBook.pages;
      document.getElementById('totalPages').textContent = totalPages;
      document.getElementById('pageInput').max = totalPages;

      // Download button
      if (currentBook.pdfUrl) {
        document.getElementById('downloadBtn').onclick = () => window.open(currentBook.pdfUrl, '_blank');
        
        // Load PDF with PDF.js
        loadPDFDocument(currentBook.pdfUrl);
      }

      document.getElementById('bookLoading').style.display = 'none';
      document.getElementById('bookContent').style.display = 'block';
    }

    // ==================== PDF.js INTEGRATION ====================

    async function loadPDFDocument(url) {
      try {
        document.getElementById('pdfLoading').style.display = 'flex';
        document.getElementById('pdfLoading').innerHTML = '<i class="fas fa-spinner fa-spin"></i><p style="color: rgba(255,255,255,0.8);">Loading PDF...</p>';
        
        pdfDoc = await pdfjsLib.getDocument(url).promise;
        totalPages = pdfDoc.numPages;
        document.getElementById('totalPages').textContent = totalPages;
        document.getElementById('pageInput').max = totalPages;
        
        document.getElementById('pdfCanvas').style.display = 'block';
        renderPage(currentPage);
        
      } catch (error) {
        console.error('PDF loading error:', error);
        document.getElementById('pdfLoading').innerHTML = `
          <i class="fas fa-exclamation-triangle" style="color: #FF9800;"></i>
          <p style="color: rgba(255,255,255,0.8);">Unable to load PDF preview</p>
          <p style="color: rgba(255,255,255,0.6); font-size: 0.9rem; margin-top: 10px;">Please use the download button to view the PDF</p>
        `;
      }
    }

    async function renderPage(num) {
      if (pageRendering) {
        pageNumPending = num;
        return;
      }
      
      pageRendering = true;
      document.getElementById('pdfLoading').style.display = 'none';
      
      try {
        const page = await pdfDoc.getPage(num);
        
        const canvas = document.getElementById('pdfCanvas');
        const ctx = canvas.getContext('2d');
        
        const viewport = page.getViewport({ scale: zoomLevel * 1.5 });
        canvas.height = viewport.height;
        canvas.width = viewport.width;
        
        const renderContext = {
          canvasContext: ctx,
          viewport: viewport
        };
        
        await page.render(renderContext).promise;
        
        pageRendering = false;
        
        if (pageNumPending !== null) {
          renderPage(pageNumPending);
          pageNumPending = null;
        }
        
      } catch (error) {
        console.error('Page rendering error:', error);
        pageRendering = false;
      }
    }

    function changePage(delta) {
      currentPage = Math.max(1, Math.min(totalPages, currentPage + delta));
      document.getElementById('pageInput').value = currentPage;
      updatePageControls();
      if (pdfDoc) renderPage(currentPage);
    }

    function goToPage() {
      const input = document.getElementById('pageInput');
      currentPage = Math.max(1, Math.min(totalPages, parseInt(input.value) || 1));
      input.value = currentPage;
      updatePageControls();
      if (pdfDoc) renderPage(currentPage);
    }

    function updatePageControls() {
      document.getElementById('prevPage').disabled = currentPage <= 1;
      document.getElementById('nextPage').disabled = currentPage >= totalPages;
    }

    function zoomIn() {
      zoomLevel = Math.min(2.0, zoomLevel + 0.1);
      document.getElementById('zoomValue').textContent = `${Math.round(zoomLevel * 100)}%`;
      if (pdfDoc) renderPage(currentPage);
    }

    function zoomOut() {
      zoomLevel = Math.max(0.5, zoomLevel - 0.1);
      document.getElementById('zoomValue').textContent = `${Math.round(zoomLevel * 100)}%`;
      if (pdfDoc) renderPage(currentPage);
    }

    function downloadPDF() {
      if (currentBook.pdfUrl) {
        const a = document.createElement('a');
        a.href = currentBook.pdfUrl;
        a.download = `${currentBook.title}.pdf`;
        a.click();
      }
    }

    function shareBook(platform) {
      const url = encodeURIComponent(window.location.href);
      const title = encodeURIComponent(currentBook.title);
      let shareUrl;
      if (platform === 'facebook') shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${url}`;
      else if (platform === 'twitter') shareUrl = `https://twitter.com/intent/tweet?url=${url}&text=${title}`;
      else if (platform === 'whatsapp') shareUrl = `https://wa.me/?text=${title}%20${url}`;
      window.open(shareUrl, '_blank', 'width=600,height=400');
    }

    function copyBookLink() { navigator.clipboard.writeText(window.location.href); }

    document.addEventListener('DOMContentLoaded', () => {
      loadBook();
      updatePageControls();
    });
  </script>

        </div> <!-- END bg-system-content -->
    </div> <!-- END bg-system-container -->
</body>
</html>
