<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Research Papers Manager - A3KM Studio</title>
  <link rel="stylesheet" href="../../../Optimization/mobile-universal.css">
  <script src="../../../Optimization/mobile-universal.js" defer></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: 'Segoe UI', sans-serif; background: #1a1a1a; background-image: linear-gradient(rgba(139, 69, 19, 0.05) 1px, transparent 1px), linear-gradient(90deg, rgba(139, 69, 19, 0.05) 1px, transparent 1px); background-size: 100px 100px; min-height: 100vh; padding: 20px; }
    .header { position: relative; z-index: 100; background: linear-gradient(135deg, rgba(139, 69, 19, 0.95), rgba(160, 82, 45, 0.98)); border-bottom: 3px solid #8B4513; box-shadow: 0 6px 25px rgba(139, 69, 19, 0.4); padding: 20px 40px; margin: -20px -20px 30px -20px; }
    .header-container { display: flex; justify-content: space-between; align-items: center; }
    .header-left { display: flex; align-items: center; gap: 20px; }
    .header-icon { width: 70px; height: 70px; background: linear-gradient(135deg, #8B4513, #A0522D); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 2.2rem; box-shadow: 0 0 40px rgba(139, 69, 19, 0.7); }
    .header-title h1 { font-size: 2rem; color: white; margin-bottom: 5px; font-weight: 800; text-shadow: 0 0 20px rgba(139, 69, 19, 0.5); }
    .header-title p { font-size: 0.95rem; color: rgba(255,255,255,0.8); }
    .header-actions { display: flex; gap: 15px; }
    .back-btn { display: inline-flex; align-items: center; gap: 10px; padding: 12px 24px; background: rgba(255, 255, 255, 0.08); color: white; border: 2px solid rgba(255, 255, 255, 0.2); border-radius: 10px; font-weight: 700; cursor: pointer; transition: all 0.3s ease; text-decoration: none; }
    .back-btn:hover { background: rgba(255, 255, 255, 0.15); transform: translateY(-2px); }
    .btn-save { display: inline-flex; align-items: center; gap: 10px; padding: 12px 24px; background: linear-gradient(135deg, #8B4513, #A0522D); color: white; border: 2px solid #8B4513; border-radius: 10px; font-weight: 700; cursor: pointer; box-shadow: 0 4px 15px rgba(139, 69, 19, 0.3); }
    .btn-save:hover { background: linear-gradient(135deg, #A0522D, #8B4513); transform: translateY(-2px); box-shadow: 0 6px 20px rgba(139, 69, 19, 0.5); }
    .container { max-width: 1600px; margin: 0 auto; padding: 0; display: grid; grid-template-columns: 280px 1fr; gap: 30px; }
    .sidebar { background: linear-gradient(135deg, rgba(139, 69, 19, 0.15), rgba(26, 0, 0, 0.25)); border: 2px solid rgba(139, 69, 19, 0.3); border-radius: 18px; padding: 25px; height: fit-content; position: sticky; top: 20px; }
    .sidebar h2 { color: #8B4513; font-size: 1.3rem; margin-bottom: 20px; display: flex; align-items: center; gap: 10px; }
    .tab-list { display: flex; flex-direction: column; gap: 10px; }
    .tab-item { padding: 12px 15px; background: rgba(139, 69, 19, 0.05); border: 2px solid transparent; border-radius: 10px; cursor: pointer; transition: all 0.3s ease; display: flex; align-items: center; gap: 10px; font-size: 0.95rem; color: #666; }
    .tab-item:hover { background: rgba(139, 69, 19, 0.15); border-color: rgba(139, 69, 19, 0.3); color: #333; transform: translateX(3px); }
    .tab-item.active { background: rgba(139, 69, 19, 0.25); border-color: #8B4513; color: #8B4513; font-weight: 700; box-shadow: 0 0 15px rgba(139, 69, 19, 0.3); }
    .tab-item i { font-size: 1.1rem; }
    .sidebar-stats { margin-top: 25px; padding-top: 20px; border-top: 2px solid rgba(139, 69, 19, 0.2); }
    .sidebar-stat { display: flex; justify-content: space-between; padding: 8px 0; font-size: 0.9rem; color: #666; }
    .sidebar-stat strong { color: #8B4513; font-weight: 700; }
    .main-content { background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(255, 255, 255, 0.9)); border: 2px solid rgba(139, 69, 19, 0.15); border-radius: 18px; padding: 35px; box-shadow: 0 10px 40px rgba(0,0,0,0.15); }
    .tab-content { display: none; }
    .tab-content.active { display: block; animation: fadeIn 0.3s ease-in; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    .content-header { margin-bottom: 30px; border-bottom: 3px solid rgba(139, 69, 19, 0.15); padding-bottom: 15px; }
    .content-header h2 { color: #8B4513; font-size: 1.8rem; margin-bottom: 8px; }
    .content-header p { color: #666; font-size: 0.95rem; }
    .dashboard-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 25px; }
    .stat-card { background: linear-gradient(135deg, #8B4513, #A0522D); padding: 25px; border-radius: 12px; color: white; box-shadow: 0 4px 15px rgba(139, 69, 19, 0.3); transition: all 0.3s; }
    .stat-card:hover { transform: translateY(-3px); box-shadow: 0 6px 25px rgba(139, 69, 19, 0.5); }
    .stat-card h3 { font-size: 2.5rem; margin-bottom: 10px; font-weight: 800; }
    .stat-card p { font-size: 0.95rem; opacity: 0.9; }
    .form-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 20px; }
    .form-group { display: flex; flex-direction: column; gap: 8px; }
    .form-group label { color: #333; font-weight: 600; font-size: 0.9rem; display: flex; align-items: center; gap: 8px; }
    .form-group input, .form-group select, .form-group textarea { padding: 12px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 0.95rem; font-family: inherit; transition: border-color 0.3s; }
    .form-group input:focus, .form-group select:focus, .form-group textarea:focus { outline: none; border-color: #8B4513; box-shadow: 0 0 0 3px rgba(139, 69, 19, 0.1); }
    .form-group textarea { resize: vertical; min-height: 100px; }
    .form-group small { color: #666; font-size: 0.85rem; }
    .btn-primary { padding: 15px 30px; background: linear-gradient(135deg, #8B4513, #A0522D); color: white; border: none; border-radius: 10px; font-weight: 700; font-size: 1rem; cursor: pointer; transition: all 0.3s; width: 100%; box-shadow: 0 4px 15px rgba(139, 69, 19, 0.3); }
    .btn-primary:hover { background: linear-gradient(135deg, #A0522D, #8B4513); transform: translateY(-2px); box-shadow: 0 6px 25px rgba(139, 69, 19, 0.5); }
    .success-message { background: linear-gradient(135deg, #4CAF50, #45a049); color: white; padding: 15px 20px; border-radius: 10px; margin-top: 20px; display: none; align-items: center; gap: 10px; font-weight: 600; box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3); }
    .success-message.active { display: flex; animation: slideDown 0.3s ease-out; }
    @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
    .filters-bar { display: grid; grid-template-columns: 2fr 1fr 1fr 1fr 1fr; gap: 15px; margin-bottom: 25px; padding: 20px; background: rgba(139, 69, 19, 0.05); border: 2px solid rgba(139, 69, 19, 0.15); border-radius: 12px; }
    .filters-bar > div { display: flex; flex-direction: column; gap: 6px; }
    .filters-bar label { font-size: 0.85rem; font-weight: 600; color: #666; }
    .filters-bar input, .filters-bar select { padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px; font-size: 0.9rem; }
    .bulk-toolbar { background: linear-gradient(135deg, rgba(139, 69, 19, 0.1), rgba(139, 69, 19, 0.05)); border: 2px solid rgba(139, 69, 19, 0.2); padding: 15px 20px; border-radius: 10px; margin-bottom: 20px; display: none; align-items: center; gap: 15px; }
    .bulk-toolbar.active { display: flex; }
    .bulk-toolbar button { padding: 8px 16px; background: white; border: 2px solid #8B4513; color: #8B4513; border-radius: 8px; font-weight: 600; font-size: 0.9rem; cursor: pointer; transition: all 0.3s; }
    .bulk-toolbar button:hover { background: #8B4513; color: white; }
    .bulk-toolbar button:last-child { background: linear-gradient(135deg, #f44336, #d32f2f); border-color: #f44336; color: white; }
    .bulk-toolbar button:last-child:hover { background: linear-gradient(135deg, #d32f2f, #b71c1c); }
    .papers-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 20px; margin-top: 20px; }
    .paper-card { background: white; border: 2px solid #e0e0e0; border-radius: 12px; overflow: hidden; transition: all 0.3s; position: relative; }
    .paper-card:hover { border-color: #8B4513; box-shadow: 0 4px 20px rgba(139, 69, 19, 0.2); transform: translateY(-3px); }
    .paper-card input[type="checkbox"] { position: absolute; top: 12px; left: 12px; width: 20px; height: 20px; cursor: pointer; z-index: 10; accent-color: #8B4513; }
    .paper-header { background: linear-gradient(135deg, #8B4513, #A0522D); padding: 20px 20px 20px 45px; min-height: 100px; display: flex; align-items: center; position: relative; }
    .paper-header::before { content: 'ğŸ“„'; position: absolute; left: 15px; top: 50%; transform: translateY(-50%); font-size: 2rem; opacity: 0.3; }
    .paper-body { padding: 20px; }
    .paper-title { font-size: 1.1rem; font-weight: 700; color: #333; margin-bottom: 10px; line-height: 1.4; }
    .paper-authors { font-size: 0.9rem; color: #666; margin-bottom: 8px; display: flex; align-items: center; gap: 5px; }
    .paper-meta { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 0.85rem; color: #999; margin-bottom: 12px; }
    .paper-meta span { display: flex; align-items: center; gap: 5px; }
    .paper-abstract { font-size: 0.9rem; color: #666; line-height: 1.5; margin-bottom: 15px; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }
    .paper-tags { display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 15px; }
    .paper-tag { font-size: 0.75rem; padding: 4px 10px; background: rgba(139, 69, 19, 0.1); color: #8B4513; border-radius: 12px; font-weight: 600; }
    .paper-actions { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; }
    .paper-actions button { padding: 10px; border: 2px solid #e0e0e0; background: white; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 0.9rem; transition: all 0.3s; }
    .paper-actions button:hover { transform: translateY(-2px); }
    .paper-actions button:nth-child(1):hover { background: #2196F3; color: white; border-color: #2196F3; }
    .paper-actions button:nth-child(2):hover { background: #8B4513; color: white; border-color: #8B4513; }
    .paper-actions button:nth-child(3):hover { background: #f44336; color: white; border-color: #f44336; }
    .pagination { display: flex; justify-content: center; align-items: center; gap: 15px; margin-top: 30px; padding: 20px; }
    .pagination.active { display: flex; }
    .pagination button { padding: 10px 20px; background: white; border: 2px solid #8B4513; color: #8B4513; border-radius: 8px; font-weight: 700; cursor: pointer; transition: all 0.3s; }
    .pagination button:hover:not(:disabled) { background: #8B4513; color: white; transform: translateY(-2px); }
    .pagination button:disabled { opacity: 0.4; cursor: not-allowed; }
    .pagination span { font-weight: 600; color: #666; font-size: 0.95rem; }
    .no-results { text-align: center; padding: 60px 20px; color: #999; display: none; }
    .no-results.active { display: block; }
    .no-results p { font-size: 1.2rem; margin-bottom: 10px; }
    .stats-section { margin-bottom: 30px; }
    .stats-section h3 { color: #8B4513; font-size: 1.3rem; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid rgba(139, 69, 19, 0.2); }
    .stats-breakdown { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; }
    .stats-item { padding: 15px; background: rgba(139, 69, 19, 0.05); border: 2px solid rgba(139, 69, 19, 0.15); border-radius: 10px; display: flex; justify-content: space-between; align-items: center; }
    .stats-item-label { font-weight: 600; color: #666; font-size: 0.9rem; }
    .stats-item-value { font-size: 1.5rem; font-weight: 800; color: #8B4513; }
    .json-editor-container { background: #1e1e1e; border: 2px solid rgba(139, 69, 19, 0.3); border-radius: 12px; padding: 20px; min-height: 500px; }
    .json-editor-toolbar { display: flex; gap: 10px; margin-bottom: 15px; }
    .json-editor-toolbar button { padding: 10px 20px; background: #8B4513; color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.3s; }
    .json-editor-toolbar button:hover { background: #A0522D; }
    .json-editor { width: 100%; min-height: 450px; background: #1e1e1e; color: #d4d4d4; border: 2px solid #333; border-radius: 8px; padding: 15px; font-family: 'Consolas', 'Monaco', monospace; font-size: 0.9rem; line-height: 1.5; }
    .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.85); z-index: 10000; overflow-y: auto; padding: 40px 20px; }
    .modal.active { display: block; animation: fadeIn 0.3s; }
    .modal-content { max-width: 900px; margin: 0 auto; background: white; border-radius: 20px; padding: 35px; position: relative; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5); }
    .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; padding-bottom: 15px; border-bottom: 3px solid rgba(139, 69, 19, 0.2); }
    .modal-header h2 { color: #8B4513; font-size: 1.8rem; }
    .modal-close { background: #f44336; color: white; border: none; width: 45px; height: 45px; border-radius: 50%; cursor: pointer; font-size: 1.5rem; display: flex; align-items: center; justify-content: center; transition: all 0.3s; }
    .modal-close:hover { background: #d32f2f; transform: rotate(90deg); }
    .progress-container { margin-top: 20px; display: none; }
    .progress-container.active { display: block; }
    .progress-bar { width: 100%; height: 10px; background: #e0e0e0; border-radius: 5px; overflow: hidden; margin-bottom: 10px; }
    .progress-fill { height: 100%; background: linear-gradient(90deg, #8B4513, #A0522D); width: 0%; transition: width 0.3s; }
    .progress-text { text-align: center; color: #8B4513; font-weight: 600; font-size: 0.9rem; }
    @media (max-width: 1200px) { .container { grid-template-columns: 1fr; } .sidebar { position: static; } }
    @media (max-width: 768px) { .filters-bar { grid-template-columns: 1fr; } .papers-grid { grid-template-columns: 1fr; } .dashboard-grid { grid-template-columns: 1fr; } }
  </style>
</head>
<body>
  <!-- Header -->
  <div class="header">
    <div class="header-container">
      <div class="header-left">
        <div class="header-icon">ğŸ“„</div>
        <div class="header-title">
          <h1>Research Papers Manager</h1>
          <p>Manage academic papers, publications & research documents</p>
        </div>
      </div>
      <div class="header-actions">
        <a href="content-hub.html" class="back-btn">â† Back to Hub</a>
        <button class="btn-save" onclick="saveToGitHub()">ğŸ’¾ Save to GitHub</button>
      </div>
    </div>
  </div>

  <div class="container">
    <!-- Sidebar -->
    <div class="sidebar">
      <h2>ğŸ“‹ Navigation</h2>
      <div class="tab-list">
        <div class="tab-item active" data-tab="dashboard" onclick="switchTab('dashboard')">
          <span>ğŸ“Š</span> Dashboard
        </div>
        <div class="tab-item" data-tab="upload" onclick="switchTab('upload')">
          <span>ğŸ“¤</span> Upload Paper
        </div>
        <div class="tab-item" data-tab="manage" onclick="switchTab('manage')">
          <span>ğŸ“š</span> Manage Papers
        </div>
        <div class="tab-item" data-tab="statistics" onclick="switchTab('statistics')">
          <span>ğŸ“ˆ</span> Statistics
        </div>
        <div class="tab-item" data-tab="json-editor" onclick="switchTab('json-editor')">
          <span>ğŸ”§</span> JSON Editor
        </div>
      </div>

      <div class="sidebar-stats">
        <div class="sidebar-stat">
          <span>Total Papers:</span>
          <strong id="sidebar-total">0</strong>
        </div>
        <div class="sidebar-stat">
          <span>Authors:</span>
          <strong id="sidebar-authors">0</strong>
        </div>
        <div class="sidebar-stat">
          <span>Citations:</span>
          <strong id="sidebar-citations">0</strong>
        </div>
        <div class="sidebar-stat">
          <span>Downloads:</span>
          <strong id="sidebar-downloads">0</strong>
        </div>
      </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <!-- Dashboard Tab -->
      <div id="dashboard-tab" class="tab-content active">
        <div class="content-header">
          <h2>ğŸ“Š Dashboard Overview</h2>
          <p>Quick statistics and insights about your research papers collection</p>
        </div>
        <div class="dashboard-grid">
          <div class="stat-card">
            <h3 id="dash-total">0</h3>
            <p>ğŸ“„ Total Research Papers</p>
          </div>
          <div class="stat-card">
            <h3 id="dash-authors">0</h3>
            <p>ğŸ‘¥ Unique Authors</p>
          </div>
          <div class="stat-card">
            <h3 id="dash-citations">0</h3>
            <p>ğŸ“‘ Total Citations</p>
          </div>
          <div class="stat-card">
            <h3 id="dash-downloads">0</h3>
            <p>â¬‡ï¸ Total Downloads</p>
          </div>
        </div>
      </div>

      <!-- Upload Tab -->
      <div id="upload-tab" class="tab-content">
        <div class="content-header">
          <h2>ğŸ“¤ Upload Research Paper</h2>
          <p>Add a new research paper to your collection</p>
        </div>
        <form id="upload-form" onsubmit="uploadPaper(event)">
          <div class="form-row">
            <div class="form-group">
              <label>ğŸ“ Category *</label>
              <select id="category" required>
                <option value="">Select category...</option>
              </select>
            </div>
            <div class="form-group">
              <label>ğŸ“Š Research Field *</label>
              <input type="text" id="field" placeholder="e.g., Machine Learning, IoT, Robotics" list="field-list" required>
              <datalist id="field-list"></datalist>
            </div>
          </div>

          <div class="form-group">
            <label>ğŸ“ Paper Title *</label>
            <input type="text" id="title" placeholder="Enter complete paper title..." required>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>ğŸ‘¤ Authors (comma-separated) *</label>
              <input type="text" id="authors" placeholder="Author 1, Author 2, Author 3" list="author-list" required>
              <datalist id="author-list"></datalist>
              <small>Enter authors separated by commas</small>
            </div>
            <div class="form-group">
              <label>ğŸ›ï¸ Institution/University *</label>
              <input type="text" id="institution" placeholder="Khulna University of Engineering & Technology" required>
            </div>
          </div>

          <div class="form-group">
            <label>ğŸ“„ Abstract/Summary *</label>
            <textarea id="abstract" placeholder="Brief abstract or summary of the research paper..." rows="5" required></textarea>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>ğŸ“… Publication Year *</label>
              <input type="number" id="year" placeholder="2024" min="1900" max="2050" required>
            </div>
            <div class="form-group">
              <label>ğŸ“š Journal/Conference *</label>
              <input type="text" id="journal" placeholder="IEEE Transactions, ACM Conference, etc." required>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>ğŸ”— DOI (Digital Object Identifier)</label>
              <input type="text" id="doi" placeholder="10.1234/example.doi">
              <small>Optional: DOI link for the paper</small>
            </div>
            <div class="form-group">
              <label>ğŸ”— PDF Download Link *</label>
              <input type="url" id="downloadUrl" placeholder="https://example.com/paper.pdf" required>
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>ğŸ·ï¸ Keywords/Tags (comma-separated) *</label>
              <input type="text" id="keywords" placeholder="IoT, Machine Learning, Sensors, Data Analysis" required>
            </div>
            <div class="form-group">
              <label>ğŸ“‘ Citations Count</label>
              <input type="number" id="citations" placeholder="0" min="0" value="0">
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>ğŸ“„ Pages</label>
              <input type="number" id="pages" placeholder="12" min="1">
            </div>
            <div class="form-group">
              <label>ğŸŒ Language *</label>
              <select id="language" required>
                <option value="en">ğŸ‡¬ğŸ‡§ English</option>
                <option value="bn">ğŸ‡§ğŸ‡© à¦¬à¦¾à¦‚à¦²à¦¾</option>
                <option value="hi">ğŸ‡®ğŸ‡³ à¤¹à¤¿à¤‚à¤¦à¥€</option>
              </select>
            </div>
          </div>

          <button type="submit" class="btn-primary">ğŸ“¤ Upload Research Paper</button>
          
          <div id="upload-success" class="success-message">
            âœ… Research paper uploaded successfully!
          </div>
        </form>
      </div>

      <!-- Manage Tab -->
      <div id="manage-tab" class="tab-content">
        <div class="content-header">
          <h2>ğŸ“š Manage Research Papers</h2>
          <p>View, edit, and delete research papers</p>
        </div>
        
        <!-- Bulk Operations Toolbar -->
        <div id="bulk-toolbar" class="bulk-toolbar">
          <strong>ğŸ“‹ <span id="selected-count">0</span> selected</strong>
          <button onclick="selectAll()">âœ… Select All</button>
          <button onclick="deselectAll()">âŒ Deselect All</button>
          <button onclick="bulkDeletePapers()">ğŸ—‘ï¸ Delete Selected</button>
        </div>

        <!-- Filters Bar -->
        <div class="filters-bar">
          <div style="flex: 2; min-width: 300px;">
            <label>ğŸ” Search:</label>
            <input type="text" id="search-input" placeholder="Search by title, authors, keywords..." oninput="applyFilters()">
          </div>
          
          <div>
            <label>Category:</label>
            <select id="filter-category" onchange="applyFilters()">
              <option value="">All Categories</option>
            </select>
          </div>
          
          <div>
            <label>Year:</label>
            <select id="filter-year" onchange="applyFilters()">
              <option value="">All Years</option>
            </select>
          </div>
          
          <div>
            <label>Language:</label>
            <select id="filter-language" onchange="applyFilters()">
              <option value="">All Languages</option>
              <option value="en">ğŸ‡¬ğŸ‡§ English</option>
              <option value="bn">ğŸ‡§ğŸ‡© à¦¬à¦¾à¦‚à¦²à¦¾</option>
              <option value="hi">ğŸ‡®ğŸ‡³ à¤¹à¤¿à¤‚à¤¦à¥€</option>
            </select>
          </div>
          
          <div>
            <label>Sort By:</label>
            <select id="sort-by" onchange="applyFilters()">
              <option value="year-desc">Year (Newest)</option>
              <option value="year-asc">Year (Oldest)</option>
              <option value="title-asc">Title (A-Z)</option>
              <option value="title-desc">Title (Z-A)</option>
              <option value="citations-desc">Most Cited</option>
              <option value="downloads-desc">Most Downloaded</option>
            </select>
          </div>
        </div>

        <!-- Papers Grid -->
        <div id="papers-grid" class="papers-grid"></div>
        
        <div id="no-results" class="no-results">
          <p>ğŸ” No research papers found</p>
          <small>Try adjusting your filters or upload a new paper</small>
        </div>

        <!-- Pagination -->
        <div id="pagination" class="pagination">
          <button onclick="prevPage()" id="prev-btn">â† Previous</button>
          <span id="page-info">Page 1 of 1</span>
          <button onclick="nextPage()" id="next-btn">Next â†’</button>
        </div>

        <!-- Progress Bar for Bulk Delete -->
        <div id="bulk-progress" class="progress-container">
          <div class="progress-bar">
            <div id="bulk-progress-fill" class="progress-fill"></div>
          </div>
          <div id="bulk-progress-text" class="progress-text">Deleting papers...</div>
        </div>
      </div>

      <!-- Statistics Tab -->
      <div id="statistics-tab" class="tab-content">
        <div class="content-header">
          <h2>ğŸ“ˆ Detailed Statistics</h2>
          <p>Comprehensive analysis of your research papers collection</p>
        </div>

        <div class="stats-section">
          <h3>ğŸ“Š Papers by Category</h3>
          <div id="category-stats" class="stats-breakdown"></div>
        </div>

        <div class="stats-section">
          <h3>ğŸ“… Papers by Year</h3>
          <div id="year-stats" class="stats-breakdown"></div>
        </div>

        <div class="stats-section">
          <h3>ğŸŒ Papers by Language</h3>
          <div id="language-stats" class="stats-breakdown"></div>
        </div>

        <div class="stats-section">
          <h3>ğŸ‘¥ Top 10 Most Productive Authors</h3>
          <div id="author-stats" class="stats-breakdown"></div>
        </div>

        <div class="stats-section">
          <h3>ğŸ“‘ Top 10 Most Cited Papers</h3>
          <div id="citations-stats" class="stats-breakdown"></div>
        </div>
      </div>

      <!-- JSON Editor Tab -->
      <div id="json-editor-tab" class="tab-content">
        <div class="content-header">
          <h2>ğŸ”§ JSON Editor</h2>
          <p>Advanced editing of papers.json file</p>
        </div>
        
        <div class="json-editor-container">
          <div class="json-editor-toolbar">
            <button onclick="validateJSON()">âœ… Validate JSON</button>
            <button onclick="formatJSON()">âœ¨ Format JSON</button>
            <button onclick="saveJSON()">ğŸ’¾ Save Changes</button>
            <button onclick="reloadJSON()">ğŸ”„ Reload Original</button>
          </div>
          <textarea id="json-editor" class="json-editor" spellcheck="false"></textarea>
        </div>
      </div>
    </div>
  </div>

  <!-- Edit Modal -->
  <div id="edit-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>âœï¸ Edit Research Paper</h2>
        <button class="modal-close" onclick="closeEditModal()">Ã—</button>
      </div>
      <form id="edit-form" onsubmit="saveEdit(event)">
        <input type="hidden" id="edit-id">
        
        <div class="form-row">
          <div class="form-group">
            <label>ğŸ“ Category</label>
            <select id="edit-category" required></select>
          </div>
          <div class="form-group">
            <label>ğŸ“Š Research Field</label>
            <input type="text" id="edit-field" required>
          </div>
        </div>

        <div class="form-group">
          <label>ğŸ“ Paper Title</label>
          <input type="text" id="edit-title" required>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>ğŸ‘¤ Authors (comma-separated)</label>
            <input type="text" id="edit-authors" required>
          </div>
          <div class="form-group">
            <label>ğŸ›ï¸ Institution</label>
            <input type="text" id="edit-institution" required>
          </div>
        </div>

        <div class="form-group">
          <label>ğŸ“„ Abstract</label>
          <textarea id="edit-abstract" rows="4" required></textarea>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>ğŸ“… Year</label>
            <input type="number" id="edit-year" required>
          </div>
          <div class="form-group">
            <label>ğŸ“š Journal</label>
            <input type="text" id="edit-journal" required>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>ğŸ”— DOI</label>
            <input type="text" id="edit-doi">
          </div>
          <div class="form-group">
            <label>ğŸ”— PDF Link</label>
            <input type="url" id="edit-downloadUrl" required>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>ğŸ·ï¸ Keywords</label>
            <input type="text" id="edit-keywords" required>
          </div>
          <div class="form-group">
            <label>ğŸ“‘ Citations</label>
            <input type="number" id="edit-citations" min="0">
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>ğŸ“„ Pages</label>
            <input type="number" id="edit-pages" min="1">
          </div>
          <div class="form-group">
            <label>ğŸŒ Language</label>
            <select id="edit-language" required>
              <option value="en">ğŸ‡¬ğŸ‡§ English</option>
              <option value="bn">ğŸ‡§ğŸ‡© à¦¬à¦¾à¦‚à¦²à¦¾</option>
              <option value="hi">ğŸ‡®ğŸ‡³ à¤¹à¤¿à¤‚à¤¦à¥€</option>
            </select>
          </div>
        </div>

        <button type="submit" class="btn-primary">ğŸ’¾ Save Changes</button>
      </form>
    </div>
  </div>

  <!-- Scripts -->
  <script src="content-manager.js"></script>
  <script src="github-content-uploader.js"></script>
  <script>
    // Global variables
    let papersData = { categoryGroups: [], papers: [] };
    let contentManager;
    let selectedPapers = new Set();
    let currentPage = 1;
    const papersPerPage = 12;
    let filteredPapers = [];
    
    // Initialize
    document.addEventListener('DOMContentLoaded', async () => {
      contentManager = new ContentManager();
      await loadPapers();
      loadCategories();
      loadFilterCategories();
      loadFieldSuggestions();
      updateDashboard();
      renderPapers();
    });

    // Load papers from JSON
    async function loadPapers() {
      try {
        papersData = await contentManager.loadJSON('Content Studio/research-papers/papers.json');
        if (!papersData.papers) papersData.papers = [];
        if (!papersData.categoryGroups) papersData.categoryGroups = [];
        filteredPapers = [...papersData.papers];
      } catch (error) {
        console.error('Error loading papers:', error);
        papersData = { categoryGroups: [], papers: [] };
        filteredPapers = [];
      }
    }

    // Load categories into dropdowns
    function loadCategories() {
      const categorySelect = document.getElementById('category');
      const editCategorySelect = document.getElementById('edit-category');
      
      categorySelect.innerHTML = '<option value="">Select category...</option>';
      editCategorySelect.innerHTML = '<option value="">Select category...</option>';
      
      if (!papersData.categoryGroups) return;
      
      papersData.categoryGroups.forEach(group => {
        const optgroup = document.createElement('optgroup');
        optgroup.label = `${group.icon || ''} ${group.name}`;
        
        const editOptgroup = document.createElement('optgroup');
        editOptgroup.label = `${group.icon || ''} ${group.name}`;
        
        if (group.categories && Array.isArray(group.categories)) {
          group.categories.forEach(cat => {
            const option = document.createElement('option');
            option.value = cat;
            option.textContent = cat;
            optgroup.appendChild(option);
            
            const editOption = document.createElement('option');
            editOption.value = cat;
            editOption.textContent = cat;
            editOptgroup.appendChild(editOption);
          });
        }
        
        categorySelect.appendChild(optgroup);
        editCategorySelect.appendChild(editOptgroup);
      });
      
      // Load author suggestions
      loadAuthorSuggestions();
    }
    
    // Load author suggestions from existing papers
    function loadAuthorSuggestions() {
      const authorDatalist = document.getElementById('author-list');
      authorDatalist.innerHTML = '';
      
      // Get all unique authors from all papers
      const allAuthors = new Set();
      papersData.papers.forEach(paper => {
        if (paper.authors && Array.isArray(paper.authors)) {
          paper.authors.forEach(author => allAuthors.add(author.trim()));
        }
      });
      
      [...allAuthors].sort().forEach(author => {
        const option = document.createElement('option');
        option.value = author;
        authorDatalist.appendChild(option);
      });
    }
    
    // Load field suggestions
    function loadFieldSuggestions() {
      const fieldDatalist = document.getElementById('field-list');
      fieldDatalist.innerHTML = '';
      
      const uniqueFields = [...new Set(papersData.papers.map(p => p.field).filter(f => f))];
      uniqueFields.sort().forEach(field => {
        const option = document.createElement('option');
        option.value = field;
        fieldDatalist.appendChild(option);
      });
    }
    
    // Load filter categories from all papers
    function loadFilterCategories() {
      const filterCategorySelect = document.getElementById('filter-category');
      const filterYearSelect = document.getElementById('filter-year');
      
      if (!filterCategorySelect) return;
      
      // Categories
      const categories = [...new Set(papersData.papers.map(p => p.category))].sort();
      while (filterCategorySelect.children.length > 1) {
        filterCategorySelect.removeChild(filterCategorySelect.lastChild);
      }
      categories.forEach(category => {
        const option = document.createElement('option');
        option.value = category;
        option.textContent = category;
        filterCategorySelect.appendChild(option);
      });
      
      // Years
      const years = [...new Set(papersData.papers.map(p => p.year))].sort((a, b) => b - a);
      years.forEach(year => {
        const option = document.createElement('option');
        option.value = year;
        option.textContent = year;
        filterYearSelect.appendChild(option);
      });
    }
    
    // Update dashboard stats
    function updateDashboard() {
      const totalPapers = papersData.papers.length;
      const uniqueAuthors = new Set();
      papersData.papers.forEach(p => {
        if (p.authors && Array.isArray(p.authors)) {
          p.authors.forEach(a => uniqueAuthors.add(a));
        }
      });
      const totalCitations = papersData.papers.reduce((sum, paper) => sum + (paper.citations || 0), 0);
      const totalDownloads = papersData.papers.reduce((sum, paper) => sum + (paper.downloads || 0), 0);
      
      // Sidebar stats
      document.getElementById('sidebar-total').textContent = totalPapers;
      document.getElementById('sidebar-authors').textContent = uniqueAuthors.size;
      document.getElementById('sidebar-citations').textContent = totalCitations;
      document.getElementById('sidebar-downloads').textContent = totalDownloads;
      
      // Dashboard cards
      document.getElementById('dash-total').textContent = totalPapers;
      document.getElementById('dash-authors').textContent = uniqueAuthors.size;
      document.getElementById('dash-citations').textContent = totalCitations;
      document.getElementById('dash-downloads').textContent = totalDownloads;
    }
    
    // Upload paper
    async function uploadPaper(event) {
      event.preventDefault();
      
      // Validation
      const category = document.getElementById('category').value;
      if (!category) {
        alert('âš ï¸ Please select a category');
        return;
      }
      
      const title = document.getElementById('title').value.trim();
      const authorsInput = document.getElementById('authors').value.trim();
      const institution = document.getElementById('institution').value.trim();
      const abstract = document.getElementById('abstract').value.trim();
      const downloadUrl = document.getElementById('downloadUrl').value.trim();
      const field = document.getElementById('field').value.trim();
      
      if (!title || !authorsInput || !institution || !abstract || !downloadUrl || !field) {
        alert('âš ï¸ Please fill in all required fields');
        return;
      }
      
      const language = document.getElementById('language').value;
      if (!['en', 'bn', 'hi'].includes(language)) {
        alert('âš ï¸ Invalid language selected');
        return;
      }
      
      // Parse authors
      const authors = authorsInput.split(',').map(a => a.trim()).filter(a => a);
      if (authors.length === 0) {
        alert('âš ï¸ Please provide at least one author');
        return;
      }
      
      // Parse keywords
      const keywordsInput = document.getElementById('keywords').value.trim();
      const keywords = keywordsInput.split(',').map(k => k.trim()).filter(k => k);
      
      const newPaper = {
        id: 'paper-' + Date.now(),
        category: category,
        field: field,
        title: title,
        authors: authors,
        institution: institution,
        abstract: abstract,
        year: parseInt(document.getElementById('year').value) || new Date().getFullYear(),
        journal: document.getElementById('journal').value.trim(),
        doi: document.getElementById('doi').value.trim() || '',
        downloadUrl: downloadUrl,
        keywords: keywords,
        citations: parseInt(document.getElementById('citations').value) || 0,
        pages: parseInt(document.getElementById('pages').value) || 0,
        language: language,
        downloads: 0,
        dateAdded: new Date().toISOString().split('T')[0]
      };
      
      papersData.papers.unshift(newPaper);
      
      try {
        await contentManager.saveJSON('Content Studio/research-papers/papers.json', papersData);
        document.getElementById('upload-success').classList.add('active');
        document.getElementById('upload-form').reset();
        
        setTimeout(() => {
          document.getElementById('upload-success').classList.remove('active');
        }, 3000);
        
        // Update UI
        filteredPapers = [...papersData.papers];
        updateDashboard();
        loadFilterCategories();
        loadFieldSuggestions();
        loadAuthorSuggestions();
        renderPapers();
      } catch (error) {
        alert('âŒ Failed to upload paper: ' + error.message);
      }
    }
    
    // Apply filters
    function applyFilters() {
      const search = document.getElementById('search-input').value.toLowerCase();
      const categoryFilter = document.getElementById('filter-category')?.value || '';
      const yearFilter = document.getElementById('filter-year')?.value || '';
      const languageFilter = document.getElementById('filter-language').value;
      const sortBy = document.getElementById('sort-by').value;
      
      // Filter
      filteredPapers = papersData.papers.filter(paper => {
        const matchSearch = !search || 
          paper.title.toLowerCase().includes(search) ||
          (paper.authors && paper.authors.join(' ').toLowerCase().includes(search)) ||
          paper.abstract.toLowerCase().includes(search) ||
          (paper.keywords && paper.keywords.join(' ').toLowerCase().includes(search));
        
        const matchCategory = !categoryFilter || paper.category === categoryFilter;
        const matchYear = !yearFilter || paper.year == yearFilter;
        const matchLanguage = !languageFilter || paper.language === languageFilter;
        
        return matchSearch && matchCategory && matchYear && matchLanguage;
      });
      
      // Sort
      if (sortBy === 'year-desc') {
        filteredPapers.sort((a, b) => (b.year || 0) - (a.year || 0));
      } else if (sortBy === 'year-asc') {
        filteredPapers.sort((a, b) => (a.year || 0) - (b.year || 0));
      } else if (sortBy === 'title-asc') {
        filteredPapers.sort((a, b) => a.title.localeCompare(b.title));
      } else if (sortBy === 'title-desc') {
        filteredPapers.sort((a, b) => b.title.localeCompare(a.title));
      } else if (sortBy === 'citations-desc') {
        filteredPapers.sort((a, b) => (b.citations || 0) - (a.citations || 0));
      } else if (sortBy === 'downloads-desc') {
        filteredPapers.sort((a, b) => (b.downloads || 0) - (a.downloads || 0));
      }
      
      currentPage = 1;
      renderPapers();
    }
    
    // Render papers
    function renderPapers() {
      const grid = document.getElementById('papers-grid');
      const noResults = document.getElementById('no-results');
      
      if (filteredPapers.length === 0) {
        grid.innerHTML = '';
        noResults.style.display = 'block';
        document.getElementById('pagination').classList.remove('active');
        return;
      }
      
      noResults.style.display = 'none';
      
      // Pagination
      const totalPages = Math.ceil(filteredPapers.length / papersPerPage);
      const startIndex = (currentPage - 1) * papersPerPage;
      const endIndex = startIndex + papersPerPage;
      const papersToShow = filteredPapers.slice(startIndex, endIndex);
      
      grid.innerHTML = '';
      papersToShow.forEach(paper => {
        const card = document.createElement('div');
        card.className = 'paper-card';
        
        const authorsDisplay = (paper.authors && paper.authors.length > 0) 
          ? paper.authors.slice(0, 2).join(', ') + (paper.authors.length > 2 ? ` +${paper.authors.length - 2} more` : '')
          : 'Unknown Author';
        
        const keywordsHTML = (paper.keywords && paper.keywords.length > 0)
          ? paper.keywords.slice(0, 5).map(k => `<span class="paper-tag">${k}</span>`).join('')
          : '';
        
        card.innerHTML = `
          <input type="checkbox" onchange="togglePaperSelection('${paper.id}')" ${selectedPapers.has(paper.id) ? 'checked' : ''}>
          <div class="paper-header">
            <h3 style="color: white; font-size: 1.1rem; font-weight: 700;">${paper.category || 'Uncategorized'}</h3>
          </div>
          <div class="paper-body">
            <div class="paper-title">${paper.title}</div>
            <div class="paper-authors">ğŸ‘¤ ${authorsDisplay}</div>
            <div class="paper-meta">
              <span>ğŸ“… ${paper.year || 'N/A'}</span>
              <span>ğŸ“š ${paper.journal || 'N/A'}</span>
              <span>ğŸ“‘ ${paper.citations || 0} citations</span>
              <span>â¬‡ï¸ ${paper.downloads || 0} downloads</span>
            </div>
            <div class="paper-abstract">${paper.abstract || 'No abstract available'}</div>
            <div class="paper-tags">${keywordsHTML}</div>
            <div class="paper-actions">
              <button onclick="window.open('${paper.downloadUrl}', '_blank')">ğŸ“„ View</button>
              <button onclick="editPaper('${paper.id}')">âœï¸ Edit</button>
              <button onclick="deletePaper('${paper.id}')">ğŸ—‘ï¸ Delete</button>
            </div>
          </div>
        `;
        
        grid.appendChild(card);
      });
      
      // Update pagination
      document.getElementById('page-info').textContent = `Page ${currentPage} of ${totalPages}`;
      document.getElementById('prev-btn').disabled = currentPage === 1;
      document.getElementById('next-btn').disabled = currentPage === totalPages;
      document.getElementById('pagination').classList.add('active');
      
      updateBulkToolbar();
    }
    
    // Pagination functions
    function prevPage() {
      if (currentPage > 1) {
        currentPage--;
        renderPapers();
      }
    }
    
    function nextPage() {
      const totalPages = Math.ceil(filteredPapers.length / papersPerPage);
      if (currentPage < totalPages) {
        currentPage++;
        renderPapers();
      }
    }
    
    // Toggle paper selection
    function togglePaperSelection(id) {
      if (selectedPapers.has(id)) {
        selectedPapers.delete(id);
      } else {
        selectedPapers.add(id);
      }
      updateBulkToolbar();
    }
    
    // Select/Deselect all
    function selectAll() {
      filteredPapers.forEach(paper => selectedPapers.add(paper.id));
      renderPapers();
    }
    
    function deselectAll() {
      selectedPapers.clear();
      renderPapers();
    }
    
    // Update bulk toolbar
    function updateBulkToolbar() {
      const toolbar = document.getElementById('bulk-toolbar');
      const count = selectedPapers.size;
      
      document.getElementById('selected-count').textContent = count;
      
      if (count > 0) {
        toolbar.classList.add('active');
      } else {
        toolbar.classList.remove('active');
      }
    }
    
    // Bulk delete papers
    async function bulkDeletePapers() {
      if (selectedPapers.size === 0) return;
      
      if (!confirm(`Delete ${selectedPapers.size} selected paper(s)?`)) return;
      
      const progressContainer = document.getElementById('bulk-progress');
      const progressFill = document.getElementById('bulk-progress-fill');
      const progressText = document.getElementById('bulk-progress-text');
      
      progressContainer.classList.add('active');
      
      const total = selectedPapers.size;
      let deleted = 0;
      
      for (const id of selectedPapers) {
        papersData.papers = papersData.papers.filter(p => p.id !== id);
        deleted++;
        
        const percentage = (deleted / total) * 100;
        progressFill.style.width = percentage + '%';
        progressText.textContent = `Deleting ${deleted} of ${total} papers...`;
        
        await new Promise(resolve => setTimeout(resolve, 100));
      }
      
      try {
        await contentManager.saveJSON('Content Studio/research-papers/papers.json', papersData);
        
        progressFill.style.width = '100%';
        progressText.textContent = `âœ… Deleted ${total} paper(s)!`;
        
        setTimeout(() => {
          progressContainer.classList.remove('active');
          selectedPapers.clear();
          filteredPapers = [...papersData.papers];
          updateDashboard();
          loadFilterCategories();
          renderPapers();
        }, 1500);
      } catch (error) {
        progressContainer.classList.remove('active');
        alert('âŒ Failed to delete papers: ' + error.message);
      }
    }
    
    // Delete single paper
    async function deletePaper(id) {
      if (!confirm('Delete this research paper?')) return;
      
      papersData.papers = papersData.papers.filter(p => p.id !== id);
      
      try {
        await contentManager.saveJSON('Content Studio/research-papers/papers.json', papersData);
        filteredPapers = [...papersData.papers];
        selectedPapers.delete(id);
        updateDashboard();
        loadFilterCategories();
        renderPapers();
        alert('âœ… Paper deleted successfully!');
      } catch (error) {
        alert('âŒ Failed to delete paper: ' + error.message);
      }
    }
    
    // Edit paper
    function editPaper(id) {
      const paper = papersData.papers.find(p => p.id === id);
      if (!paper) return;
      
      document.getElementById('edit-id').value = id;
      document.getElementById('edit-category').value = paper.category;
      document.getElementById('edit-field').value = paper.field || '';
      document.getElementById('edit-title').value = paper.title;
      document.getElementById('edit-authors').value = (paper.authors || []).join(', ');
      document.getElementById('edit-institution').value = paper.institution || '';
      document.getElementById('edit-abstract').value = paper.abstract || '';
      document.getElementById('edit-year').value = paper.year || '';
      document.getElementById('edit-journal').value = paper.journal || '';
      document.getElementById('edit-doi').value = paper.doi || '';
      document.getElementById('edit-downloadUrl').value = paper.downloadUrl || '';
      document.getElementById('edit-keywords').value = (paper.keywords || []).join(', ');
      document.getElementById('edit-citations').value = paper.citations || 0;
      document.getElementById('edit-pages').value = paper.pages || '';
      document.getElementById('edit-language').value = paper.language || 'en';
      
      document.getElementById('edit-modal').classList.add('active');
    }
    
    function closeEditModal() {
      document.getElementById('edit-modal').classList.remove('active');
    }
    
    // Save edit
    async function saveEdit(event) {
      event.preventDefault();
      
      const id = document.getElementById('edit-id').value;
      const paperIndex = papersData.papers.findIndex(p => p.id === id);
      
      if (paperIndex === -1) return;
      
      const authorsInput = document.getElementById('edit-authors').value.trim();
      const keywordsInput = document.getElementById('edit-keywords').value.trim();
      
      papersData.papers[paperIndex] = {
        ...papersData.papers[paperIndex],
        category: document.getElementById('edit-category').value,
        field: document.getElementById('edit-field').value.trim(),
        title: document.getElementById('edit-title').value.trim(),
        authors: authorsInput.split(',').map(a => a.trim()).filter(a => a),
        institution: document.getElementById('edit-institution').value.trim(),
        abstract: document.getElementById('edit-abstract').value.trim(),
        year: parseInt(document.getElementById('edit-year').value) || new Date().getFullYear(),
        journal: document.getElementById('edit-journal').value.trim(),
        doi: document.getElementById('edit-doi').value.trim(),
        downloadUrl: document.getElementById('edit-downloadUrl').value.trim(),
        keywords: keywordsInput.split(',').map(k => k.trim()).filter(k => k),
        citations: parseInt(document.getElementById('edit-citations').value) || 0,
        pages: parseInt(document.getElementById('edit-pages').value) || 0,
        language: document.getElementById('edit-language').value
      };
      
      try {
        await contentManager.saveJSON('Content Studio/research-papers/papers.json', papersData);
        closeEditModal();
        filteredPapers = [...papersData.papers];
        updateDashboard();
        loadFilterCategories();
        loadFieldSuggestions();
        loadAuthorSuggestions();
        renderPapers();
        alert('âœ… Paper updated successfully!');
      } catch (error) {
        alert('âŒ Failed to update paper: ' + error.message);
      }
    }
    
    // Update statistics
    function updateStatistics() {
      // Category stats
      const categoryStats = {};
      papersData.papers.forEach(paper => {
        categoryStats[paper.category] = (categoryStats[paper.category] || 0) + 1;
      });
      
      const categoryStatsDiv = document.getElementById('category-stats');
      categoryStatsDiv.innerHTML = '';
      Object.entries(categoryStats).sort((a, b) => b[1] - a[1]).forEach(([cat, count]) => {
        categoryStatsDiv.innerHTML += `
          <div class="stats-item">
            <span class="stats-item-label">${cat}</span>
            <span class="stats-item-value">${count}</span>
          </div>
        `;
      });
      
      // Year stats
      const yearStats = {};
      papersData.papers.forEach(paper => {
        const year = paper.year || 'Unknown';
        yearStats[year] = (yearStats[year] || 0) + 1;
      });
      
      const yearStatsDiv = document.getElementById('year-stats');
      yearStatsDiv.innerHTML = '';
      Object.entries(yearStats).sort((a, b) => b[0] - a[0]).forEach(([year, count]) => {
        yearStatsDiv.innerHTML += `
          <div class="stats-item">
            <span class="stats-item-label">${year}</span>
            <span class="stats-item-value">${count}</span>
          </div>
        `;
      });
      
      // Language stats
      const languageStats = {};
      papersData.papers.forEach(paper => {
        const lang = paper.language === 'en' ? 'ğŸ‡¬ğŸ‡§ English' : paper.language === 'bn' ? 'ğŸ‡§ğŸ‡© à¦¬à¦¾à¦‚à¦²à¦¾' : paper.language === 'hi' ? 'ğŸ‡®ğŸ‡³ à¤¹à¤¿à¤‚à¤¦à¥€' : 'Other';
        languageStats[lang] = (languageStats[lang] || 0) + 1;
      });
      
      const languageStatsDiv = document.getElementById('language-stats');
      languageStatsDiv.innerHTML = '';
      Object.entries(languageStats).sort((a, b) => b[1] - a[1]).forEach(([lang, count]) => {
        languageStatsDiv.innerHTML += `
          <div class="stats-item">
            <span class="stats-item-label">${lang}</span>
            <span class="stats-item-value">${count}</span>
          </div>
        `;
      });
      
      // Top authors
      const authorPaperCount = {};
      papersData.papers.forEach(paper => {
        if (paper.authors && Array.isArray(paper.authors)) {
          paper.authors.forEach(author => {
            authorPaperCount[author] = (authorPaperCount[author] || 0) + 1;
          });
        }
      });
      
      const authorStatsDiv = document.getElementById('author-stats');
      authorStatsDiv.innerHTML = '';
      Object.entries(authorPaperCount).sort((a, b) => b[1] - a[1]).slice(0, 10).forEach(([author, count]) => {
        authorStatsDiv.innerHTML += `
          <div class="stats-item">
            <span class="stats-item-label">${author}</span>
            <span class="stats-item-value">${count}</span>
          </div>
        `;
      });
      
      // Top cited papers
      const citationsStatsDiv = document.getElementById('citations-stats');
      citationsStatsDiv.innerHTML = '';
      [...papersData.papers].sort((a, b) => (b.citations || 0) - (a.citations || 0)).slice(0, 10).forEach(paper => {
        citationsStatsDiv.innerHTML += `
          <div class="stats-item">
            <span class="stats-item-label">${paper.title.substring(0, 40)}...</span>
            <span class="stats-item-value">${paper.citations || 0}</span>
          </div>
        `;
      });
    }
    
    // JSON Editor functions
    function validateJSON() {
      const editor = document.getElementById('json-editor');
      try {
        JSON.parse(editor.value);
        alert('âœ… JSON is valid!');
      } catch (error) {
        alert('âŒ Invalid JSON: ' + error.message);
      }
    }
    
    function formatJSON() {
      const editor = document.getElementById('json-editor');
      try {
        const formatted = JSON.stringify(JSON.parse(editor.value), null, 2);
        editor.value = formatted;
        alert('âœ¨ JSON formatted successfully!');
      } catch (error) {
        alert('âŒ Cannot format invalid JSON: ' + error.message);
      }
    }
    
    async function saveJSON() {
      const editor = document.getElementById('json-editor');
      try {
        const data = JSON.parse(editor.value);
        await contentManager.saveJSON('Content Studio/research-papers/papers.json', data);
        papersData = data;
        filteredPapers = [...papersData.papers];
        updateDashboard();
        loadFilterCategories();
        renderPapers();
        alert('âœ… JSON saved successfully!');
      } catch (error) {
        alert('âŒ Failed to save: ' + error.message);
      }
    }
    
    async function reloadJSON() {
      await loadPapers();
      document.getElementById('json-editor').value = JSON.stringify(papersData, null, 2);
      alert('ğŸ”„ JSON reloaded from file!');
    }
    
    // Tab switching
    function switchTab(tabName) {
      document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
      document.querySelectorAll('.tab-item').forEach(item => item.classList.remove('active'));
      
      document.getElementById(tabName + '-tab').classList.add('active');
      document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
      
      if (tabName === 'statistics') {
        updateStatistics();
      } else if (tabName === 'json-editor') {
        document.getElementById('json-editor').value = JSON.stringify(papersData, null, 2);
      } else if (tabName === 'manage') {
        applyFilters();
      }
    }
    
    // Save to GitHub
    async function saveToGitHub() {
      if (!confirm('Save papers.json to GitHub?')) return;
      
      try {
        const uploader = new GitHubContentUploader();
        await uploader.uploadFile(
          'Content Studio/research-papers/papers.json',
          JSON.stringify(papersData, null, 2),
          'Updated research papers data'
        );
        alert('âœ… Saved to GitHub successfully!');
      } catch (error) {
        alert('âŒ Failed to save to GitHub: ' + error.message);
      }
    }
  </script>
</body>
</html>
